# 系統開發規劃文件

本文檔旨在規劃「美甲預約系統」的店家管理後台與顧客端 LIFF 介面的開發細節，包括技術選型、頁面功能、使用者流程以及所需的後端 API 支援。

---

## 1. 店家管理後台系統 (Admin Panel)

此系統的核心目標是提供店家一個高效率、資訊清晰的管理工具，以便快速掌握營運狀況。

### A. 技術棧建議

- **前端框架**: **React** - 生態成熟，社群龐大，適合建構複雜的管理介面。
- **UI 元件庫**: **Material-UI (MUI)** 或 **Ant Design** - 提供專業且功能強大的現成元件，特別是行事曆與資料表格，能大幅加速開發。
- **API 串接**: 使用 `axios` 或原生 `fetch` API。
- **圖表庫**: `Recharts` 或 `Chart.js`，用於儀表板的數據視覺化。

### B. 頁面與功能規劃

#### 1. 儀表板 (Dashboard)
- **路徑**: `/`
- **目的**: 登入後首頁，提供關鍵資訊概覽。
- **元件**:
  - **今日預約列表**: 顯示時間、顧客姓名、服務項目。
  - **本週預約統計**: 以長條圖顯示每日預約數。
- **所需 API**:
  - `GET /api/v1/dashboard/summary`: 取得儀表板摘要資訊。

#### 2. 行事曆管理 (Calendar)
- **路徑**: `/calendar`
- **目的**: 以視覺化方式呈現與管理所有預約。
- **元件**:
  - **全頁行事曆**: 支援月、週、日檢視模式。
  - **預約事件**: 點擊可查看詳情或進行修改。
  - **快速新增**: 點擊空白處可直接新增預約。
- **所需 API**:
  - `GET /api/v1/appointments?start_date=YYYY-MM-DD&end_date=YYYY-MM-DD`: 取得指定日期範圍內的所有預約。

#### 3. 預約管理 (Appointments)
- **路徑**: `/appointments`
- **目的**: 以列表形式進行詳細的預約管理與查詢。
- **元件**:
  - **資料表格**: 展示所有預約詳情。
  - **篩選與搜尋**: 可依日期、顧客、狀態進行查詢。
  - **操作按鈕**:
    - 新增、編輯、取消預約。
    - 標記完成（可連動建立消費紀錄）。
- **所需 API**:
  - `GET /api/v1/appointments`: 取得所有預約（支援分頁與篩選）。
  - `POST /api/v1/appointments`: 手動新增預約。
  - `PUT /api/v1/appointments/{id}`: 更新預約資訊（含狀態變更）。
  - `DELETE /api/v1/appointments/{id}`: 刪除預約。

#### 4. 時段管理 (Schedule)
- **路徑**: `/schedule`
- **目的**: 設定營業與休息時間。
- **元件**:
  - **週營業時間設定**: 表單形式，設定週一至週日的營業時段。
  - **特殊休假管理**: 新增或刪除特定日期的休假時段。
- **所需 API**:
  - `GET /api/v1/business_hours`
  - `POST /api/v1/business_hours` (批次更新)
  - `GET /api/v1/time_off`
  - `POST /api/v1/time_off`
  - `DELETE /api/v1/time_off/{id}`

#### 5. 服務管理 (Services)
- **路徑**: `/services`
- **目的**: 管理店家提供的服務項目。
- **元件**:
  - **CRUD 介面**: 使用表格與表單進行服務的新增、修改、刪除。
- **所需 API**:
  - `GET /api/v1/services`
  - `POST /api/v1/services`
  - `PUT /api/v1/services/{id}`
  - `DELETE /api/v1/services/{id}`

---

## 2. 顧客端 LIFF 介面 (Customer LIFF Interface)

此介面的核心目標是提供顧客一個簡單直覺、操作流暢的預約體驗。

### A. 技術棧建議

- **前端框架**: **React** (或 Preact/Vue) - 可與後台共用部分邏輯。
- **UI 框架**: **Bootstrap** 或 **Tailwind CSS** - 適合開發響應式、行動裝置優先的介面。
- **LIFF SDK**: 必須整合 LINE LIFF SDK 以串接 LINE 的功能。

### B. 頁面與使用者流程

建議採用單頁應用 (SPA) 的形式，引導使用者完成以下步驟：

1.  **進入點**:
    - 顧客在 LINE Rich Menu 點擊「我要預約」，開啟 LIFF 視窗。

2.  **初始化**:
    - 頁面載入後，呼叫 `liff.init()`。
    - 透過 `liff.getProfile()` 取得 User ID，並傳送至後端進行登入或自動註冊。
    - **所需 API**: `POST /api/v1/users/login`

3.  **步驟一：選擇日期**:
    - **介面**: 顯示一個全螢幕日曆，禁用過去的日期。
    - **流程**: 顧客選定日期後，自動進入下一步。

4.  **步驟二：選擇時段**:
    - **介面**: 根據選擇的日期，動態生成可預約時段的按鈕。
    - **流程**:
      - 呼叫 `GET /api/v1/slots/{selected_date}` 取得可用時段。
      - 若無可用時段，顯示提示訊息。
      - 顧客選定時段後，自動進入下一步。

5.  **步驟三：選擇服務**:
    - **介面**: 顯示服務列表（含名稱、價格、時長）。
    - **流程**:
      - 呼叫 `GET /api/v1/services` 取得所有上架服務。
      - 顧客選定服務後，進入確認頁。

6.  **步驟四：確認預約**:
    - **介面**: 顯示預約摘要（服務、時間、金額）。
    - **流程**: 提供「確認預約」按鈕與「返回修改」連結。

7.  **完成預約**:
    - **流程**:
      - 點擊確認後，呼叫 `POST /api/v1/appointments` 建立預約。
      - 成功後，顯示成功訊息，並在數秒後自動關閉 LIFF 視窗 (`liff.closeWindow()`)。
    - **後端連動**: 預約建立成功後，後端應觸發 LINE Push API 發送確認通知給顧客。
